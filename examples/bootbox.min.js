/**
 * bootbox.js v4.4.0
 *
 * http://bootboxjs.com/license.txt
 */
String.prototype.format=function(){for(var t=this,o=arguments.length;o--;)t=t.replace(new RegExp("\\{"+o+"\\}","gm"),arguments[o]);return t},!function(t){t.timeoutDialog=function(o){var e={timeout:1200,countdown:60,title:"Your session is about to expire!",message:"You will be logged out in {0}.",question:"Do you want to stay signed in?",keep_alive_button_text:"Yes, Keep me signed in",sign_out_button_text:"No, Sign me out",keep_alive_url:"/keep-alive",logout_url:null,logout_redirect_url:"/",restart_on_yes:!0};t.extend(e,o);var n={init:function(){this.setupDialogTimer()},setupDialogTimer:function(){var t=this;window.setTimeout(function(){t.setupDialog()},1e3*(e.timeout-e.countdown))},setupDialog:function(){var t=this;t.destroyDialog(),bootbox.dialog({closeButton:!1,message:e.message.format(t.getTimeString(e.countdown))+"<br />"+e.question,title:e.title,className:"session-timout-warning",buttons:{stayLoggedIn:{label:e.keep_alive_button_text,className:"btn-primary",callback:function(){t.keepAlive()}},signOut:{label:e.sign_out_button_text,className:"btn-main",callback:function(){t.signOut(!0)}}}}),t.startCountdown()},destroyDialog:function(){t("#timeout-dialog").length&&(t(this).dialog("close"),t("#timeout-dialog").remove())},getTimeString:function(t){var o=Math.floor(t/60),e=t-60*o,n="";return n='<span id="timeout-countdown">',o>0&&(n+=o+" minutes "),n+=e+" seconds</span>"},startCountdown:function(){var o=this,n=e.countdown;this.countdown=window.setInterval(function(){n-=1,t("#timeout-countdown").html(o.getTimeString(n)),0>=n&&(window.clearInterval(o.countdown),o.signOut(!1))},1e3)},keepAlive:function(){var o=this;this.destroyDialog(),window.clearInterval(this.countdown),t.get(e.keep_alive_url,function(t){"OK"===t?e.restart_on_yes&&o.setupDialogTimer():o.signOut(!1)})},signOut:function(o){var n=this;this.destroyDialog(),null!==e.logout_url?t.post(e.logout_url,function(t){n.redirectLogout(o)}).fail(function(t){console.log(t)}):n.redirectLogout(o)},redirectLogout:function(t){var o=e.logout_redirect_url+"?next="+encodeURIComponent(window.location.pathname+window.location.search);t||(o+="&timeout=t"),window.location=o}};n.init()}}(window.jQuery);